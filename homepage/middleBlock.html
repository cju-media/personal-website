<div data-github-loader="middle"></div>

<script>
  (function() {
    // 1. UNIQUE CONFIG FOR THIS INSTANCE
    const config = {
      owner: 'cju-media',
      repo: 'personal-website',
      branch: 'main', // Ensure this matches your branch (e.g., 'main' or 'master')
      path: 'homepage/homepageMiddle.html',
      // This matches the data-attribute above
      targetSelector: '[data-github-loader="middle"]' 
    };
    
    // Switch to Raw Content URL to avoid API rate limits
    const url = `https://raw.githubusercontent.com/${config.owner}/${config.repo}/${config.branch}/${config.path}`;

    fetch(url)
      .then(response => {
        if (!response.ok) throw new Error('GitHub Raw connection failed');
        return response.text();
      })
      .then(data => {
        const container = document.querySelector(config.targetSelector);
        if (!container) return;

        container.innerHTML = data;
        
        // 2. Safely execute the encapsulated scripts
        const scripts = container.querySelectorAll('script');
        scripts.forEach(oldScript => {
          const newScript = document.createElement("script");
          // Copy attributes (like src or type)
          Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
          // Copy internal code
          newScript.appendChild(document.createTextNode(oldScript.innerHTML));
          // Replace to trigger execution
          oldScript.parentNode.replaceChild(newScript, oldScript);
        });
      })
      .catch(err => {
        console.error('Fetch Error:', err);
        const container = document.querySelector(config.targetSelector);
        // Clean fail: clear text so user sees nothing instead of an error message
        if (container) container.innerHTML = ''; 
      });
  })();
</script>