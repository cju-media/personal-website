<div data-github-loader="middle">Syncing latest version from GitHub...</div>

<script>
  (function() {
    // 1. UNIQUE CONFIG FOR THIS INSTANCE
    const config = {
      owner: 'cju-media',
      repo: 'personal-website',
      path: 'homepage/homepageMiddle.html',
      // This matches the data-attribute above
      targetSelector: '[data-github-loader="middle"]' 
    };
    
    const url = `https://api.github.com/repos/${config.owner}/${config.repo}/contents/${config.path}`;

    fetch(url, {
      headers: { 'Accept': 'application/vnd.github.v3.raw' }
    })
      .then(response => {
        if (!response.ok) throw new Error('GitHub API error');
        return response.text();
      })
      .then(data => {
        const container = document.querySelector(config.targetSelector);
        if (!container) return;

        container.innerHTML = data;
        
        // 2. Safely execute the encapsulated scripts
        const scripts = container.querySelectorAll('script');
        scripts.forEach(oldScript => {
          const newScript = document.createElement("script");
          // Copy attributes (like src or type)
          Array.from(oldScript.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value));
          // Copy internal code
          newScript.appendChild(document.createTextNode(oldScript.innerHTML));
          // Replace to trigger execution
          oldScript.parentNode.replaceChild(newScript, oldScript);
        });
      })
      .catch(err => {
        console.error('Fetch Error:', err);
        const container = document.querySelector(config.targetSelector);
        if (container) container.innerHTML = 'Updating...';
      });
  })();
</script>