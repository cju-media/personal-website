<body>
<script>
    // Squarespace stub for standalone testing if needed
    if (typeof Squarespace === 'undefined') {
        var Squarespace = { onInitialize: (Y, init) => { window.addEventListener('load', init); } };
        var Y = null;
    }
    Squarespace.onInitialize(Y, init1)

    function init1() {
        // --- SETTINGS ---------------------------------------
        const staggerTime = 0.8;
        // ----------------------------------------------------

        // 1. Setup Headshots
        var headshots = [
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/644efda7500cc0360cc27deb/1682898347204/CameronJohnston_0284.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/644f01e333e0c877df609476/1682899430658/CameronJohnston_0336.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518be13b03f710fc3a0c71/1683065829787/CameronJohnston_0204.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518c04c9c92954c7c3ec91/1683065866184/CameronJohnston_0253.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518e71bcdeba02523343a0/1683066486022/CameronJohnston_0412.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518e941c027e3b22aad8fd/1683066520574/CameronJohnston_0041.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518be13b03f710fc3a0c71/1683065829787/CameronJohnston_0204.JPG",
            "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/64518bf0b57fdd1b3e56e07e/1683065845110/CameronJohnston_0217.JPG"
        ];
        var randomIndexHeadshots1 = Math.floor(Math.random() * headshots.length);
        var headshot1 = headshots[randomIndexHeadshots1];
        var myHeadshot1 = document.getElementById("myHeadshot1");
        if(myHeadshot1) myHeadshot1.src = headshot1;

        // 2. Setup Letters
        const columns = document.querySelectorAll('.text-block1 h1');

        columns.forEach((col, colIndex) => {
            const letters = col.querySelectorAll('.span-class');
            letters.forEach((span, index) => {
                span.dataset.wordIndex = colIndex;

                // Keep the wide fly-in range
                const randomX = (Math.random() - 0.5) * 2400;
                const randomY = (Math.random() - 0.5) * 2400;
                const randomRotate = (Math.random() - 0.5) * 360;

                span.style.transform = `translate(${randomX}px, ${randomY}px) rotate(${randomRotate}deg)`;
                span.style.opacity = "0";
                span.style.transitionDelay = `${index * staggerTime}s`;
            });
        });

        // 3. Setup Intersection Observer
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry) => {
                if (entry.isIntersecting) {
                    const letters = entry.target.querySelectorAll('.span-class');
                    letters.forEach((letter) => {
                        letter.classList.add('landed');
                    });
                    entry.target.classList.add('show1');
                }
            });
        }, { threshold: 0.1 });

        const textBlock = document.querySelector('.text-block1');
        if(textBlock) observer.observe(textBlock);

        const hiddenElements = document.querySelectorAll('.hidden1');
        hiddenElements.forEach((el) => observer.observe(el));

        // 4. Animation Loops
        const fontClasses = ['font1', 'font2', 'font3', 'font4', 'font5', 'font6'];
        const colors = ['#2F4F4F', '#4B0082', '#8B0000', '#000080', '#556B2F', '#8B4513', '#2E0854', '#191970'];
        const katakanaMap = {
            'A': 'ア', 'B': 'ブ', 'C': 'ク', 'D': 'デ', 'E': 'エ',
            'F': 'フ', 'G': 'グ', 'H': 'ハ', 'I': 'イ', 'J': 'ジ',
            'K': 'ケ', 'L': 'ル', 'M': 'ム', 'N': 'ン', 'O': 'オ',
            'P': 'プ', 'Q': 'キュ', 'R': 'ラ', 'S': 'ス', 'T': 'ト',
            'U': '牛', 'V': 'ヴ', 'W': 'ワ', 'X': 'クス', 'Y': 'ヤ', 'Z': 'ズ'
        };

        function changeFontRandomly(span) {
            if (!span.dataset.original) {
                span.dataset.original = span.innerText;
            }
            fontClasses.forEach(fontClass => span.classList.remove(fontClass));
            const randomIndex = Math.floor(Math.random() * fontClasses.length);
            span.classList.add(fontClasses[randomIndex]);

            if (Math.random() < 0.05) {
                const originalChar = span.dataset.original.toUpperCase();
                const wordIndex = parseInt(span.dataset.wordIndex);

                if (wordIndex === 2 && originalChar === 'J') {
                     span.innerText = '島';
                }
                else if (katakanaMap[originalChar]) {
                    span.innerText = katakanaMap[originalChar];
                }
            } else {
                span.innerText = span.dataset.original;
            }

            const interval = Math.floor(Math.random() * (700 - 300 + 1)) + 300;
            setTimeout(() => changeFontRandomly(span), interval);
        }

        function changeColorRandomly(span) {
            const randomColorIndex = Math.floor(Math.random() * colors.length);
            span.style.color = colors[randomColorIndex];
            const interval = Math.floor(Math.random() * (1500 - 800 + 1)) + 800;
            setTimeout(() => changeColorRandomly(span), interval);
        }

        const allSpans = document.querySelectorAll('.text-block1 .span-class');
        allSpans.forEach(span => {
            changeFontRandomly(span);
            changeColorRandomly(span);
        });
    }
</script>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Playfair+Display&family=VT323&display=swap');

    /* REMOVED THE HTML/BODY LOCK HERE */

    .font1 { font-family: Arial, sans-serif; }
    .font2 { font-family: "Times New Roman", serif; }
    .font3 { font-family: "Courier New", monospace; }
    .font4 { font-family: "essay-text", monospace; }
    .font5 { font-family: 'Playfair Display', serif; }
    .font6 { font-family: 'VT323', monospace; font-size: 1.1em; }

    .container1 {
        /* FIXED HEIGHT SECTION: Prevents vertical shaking */
        position: relative;

        /* FULL WIDTH HACK FOR SQUARESPACE */
        /* This ensures the container spans the full screen width */
        width: 100vw;
        left: 50%;
        margin-left: -50vw;

        /* THE FIX: Hide overflow LOCALLY */
        /* This stops the horizontal scrollbar from appearing */
        /* while still allowing the letters to appear from the edges */
        overflow: hidden;

        height: 600px;
        min-height: 600px;
    }

    .image-left1 {
        flex: 0 1 35vw;
        max-width: 450px;
    }

    .text-block1 {
        /* ABSOLUTE POSITIONING: Centers text and ignores layout flow */
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);

        display: flex;
        flex-direction: row;
        justify-content: center;
        align-items: flex-start;
        gap: 40px;
        perspective: 1000px;
        width: 100%;
    }

    .text-block1 br { display: none !important; }

    .text-block1 h1 {
        display: flex;
        flex-direction: column;
        align-items: center;
        font-size: clamp(16px, 3.5vw, 40px);
        margin: 0;
        padding: 0;
        line-height: 1.1;
        height: auto;
        width: auto;
    }

    .span-class {
        /* FIXED LETTER SIZE */
        display: flex;
        justify-content: center;
        align-items: center;
        width: 1.4em;
        height: 1.4em;
        overflow: hidden;

        z-index: 4;
        position: relative;
        will-change: transform, opacity;
        transition: transform 1.5s cubic-bezier(0.19, 1, 0.22, 1), opacity 1.5s ease-out;
        margin-bottom: 5px;
        opacity: 0;
    }

    .span-class.landed {
        transform: translate(0, 0) rotate(0deg) !important;
        opacity: 1 !important;
    }

    @media only screen and (max-width: 800px) {
        .container1 {
            height: 700px;
            min-height: 700px;
        }
        .text-block1 {
            gap: 20px;
        }
        .text-block1 h1 {
            font-size: 6vw;
        }
    }

    .hidden1 {
        opacity: 0;
        filter: blur(5px);
        transition: all 1s ease-out;
    }

    .show1 {
        opacity: 1;
        filter: blur(0);
    }
</style>

    <div class="container1">
        <div class="text-block1">
            <h1>
                <span class="span-class">C</span><span class="span-class">A</span><span class="span-class">M</span><span class="span-class">E</span><span class="span-class">R</span><span class="span-class">O</span><span class="span-class">N</span>
            </h1>
            <br>
            <h1>
                <span class="span-class">J</span><span class="span-class">O</span><span class="span-class">H</span><span class="span-class">N</span><span class="span-class">S</span><span class="span-class">T</span><span class="span-class">O</span><span class="span-class">N</span>
            </h1>
            <br>
             <h1>
                <span class="span-class">U</span><span class="span-class">S</span><span class="span-class">H</span><span class="span-class">I</span><span class="span-class">J</span><span class="span-class">I</span><span class="span-class">M</span><span class="span-class">A</span>
            </h1>
        </div>
    </div>

<div class="hp-mid-wrapper">
<style>
    /* 1. WRAPPER & LAYOUT */
    .hp-mid-wrapper {
        width: 100%;
        margin: 0 auto !important;
        display: flex;
        flex-direction: column;
        align-items: center;
        overflow: visible;
    }

    .hp-mid-wrapper section {
        display: block;
        text-align: center;
        width: 95%;
        max-width: 2000px;
        margin: 0 auto 50px auto;
        padding: 0 !important;
    }

    /* 2. THE CONTAINER */
    .hp-mid-wrapper .image-container,
    .hp-mid-wrapper .video-container {
        overflow: hidden;
        position: relative;
        width: 100%;
        height: 300px;
        border-radius: 10px;
        background: #000;
        display: flex !important;
        justify-content: center !important;
        align-items: center !important;
        text-decoration: none;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        transition: transform 0.6s cubic-bezier(0.25, 1, 0.5, 1), box-shadow 0.6s ease;
    }

    .hp-mid-wrapper .image-container:hover,
    .hp-mid-wrapper .video-container:hover {
        transform: scale(1.02);
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        z-index: 20;
    }

    /* 3. VIDEO STACKING */
    .hp-mid-wrapper .noise-bg {
        position: absolute !important;
        top: 0 !important; left: 0 !important;
        width: 100% !important; height: 100% !important;
        object-fit: cover !important;
        z-index: 1;
        opacity: 1 !important;
    }

    .hp-mid-wrapper .cropped-image,
    .hp-mid-wrapper .cropped-video {
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) scale(1.15) !important;
        width: 100% !important;
        height: 100% !important;
        object-fit: cover !important;
        z-index: 2;
        opacity: 1;
        filter: blur(6px);
        transition: transform 0.8s ease, filter 0.8s ease;
    }

    .hp-mid-wrapper .image-container:hover .cropped-image,
    .hp-mid-wrapper .video-container:hover .cropped-video {
        filter: blur(0px);
    }

    /* 4. TEXT OVERLAYS */
    .hp-mid-wrapper .text-wrapper {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10;
        width: 100%;
        pointer-events: none;
    }

    .hp-mid-wrapper .text-overlay, .hp-mid-wrapper .text-overlay1 {
        padding: 12px 24px;
        border-radius: 8px;
        backdrop-filter: blur(8px);
        display: inline-block;
        letter-spacing: 2px;
        font-weight: bold;
        text-transform: uppercase;
    }

    .hp-mid-wrapper .text-overlay { background: rgba(255,255,255,0.7); color: black; }
    .hp-mid-wrapper .text-overlay1 { background: rgba(0,0,0,0.6); color: white; }

    /* 5. RANDOM FLY-IN ANIMATIONS */
    .hp-mid-wrapper .hidden-slide {
        opacity: 0;
        filter: blur(5px);

        /* CHANGED: Increased time to 2.5s */
        transition: transform 2.5s cubic-bezier(0.19, 1, 0.22, 1), opacity 2.5s ease-out, filter 2.5s ease-out;

        /* CHANGED: Added 0.5s delay */
        transition-delay: 0.1s;

        will-change: transform, opacity;
    }

    .hp-mid-wrapper .show-slide {
        opacity: 1 !important;
        filter: blur(0px);
        transform: translate(0, 0) rotate(0deg) !important;
    }

    .glitch-char { 
        display: inline-block; 
    }

    @media screen and (max-width: 768px) {
        .hp-mid-wrapper { overflow-x: hidden; }
        .hp-mid-wrapper section { width: 90% !important; margin: 0 auto 25px auto !important; }
        .hp-mid-wrapper .image-container, .hp-mid-wrapper .video-container { height: 360px !important; }
    }
</style>

    <section class="hidden-slide"><a href="/media/avengineering" class="image-container"><img id='mid-av' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay1">AUDIO/VIDEO ENGINEER</h2></div></a></section>
    <section class="hidden-slide"><a href="/highlights/music" class="image-container"><img id='mid-composer' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay">COMPOSER</h2></div></a></section>
    <section class="hidden-slide"><a href="/highlights/max" class="image-container"><img id='sound' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay">SOUND ARTIST</h2></div></a></section>

    <section class="hidden-slide">
        <a href="/director/laptop-ensemble" class="video-container">
            <video src="https://www.cameronjohnston.xyz/s/noise4.mov" autoplay loop muted playsinline class="noise-bg"></video>
            <video playsinline autoplay muted id='mid-laptop' class='cropped-video'></video>
            <div class="text-wrapper"><h2 class="text-overlay1">LAPTOP PERFORMER</h2></div>
        </a>
    </section>

    <section class="hidden-slide">
        <a href="/highlights/videoart" class="video-container">
            <video src="https://www.cameronjohnston.xyz/s/noise4.mov" autoplay loop muted playsinline class="noise-bg"></video>
            <video playsinline autoplay muted id='mid-video' class='cropped-video'></video>
            <div class="text-wrapper"><h2 class="text-overlay1">VIDEO ARTIST</h2></div>
        </a>
    </section>

    <section class="hidden-slide"><a href="/programming" class="image-container"><img id='mid-programmer' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay1">PROGRAMMER</h2></div></a></section>
    <section class="hidden-slide"><a href="/albums" class="image-container"><img id='mid-producer' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay1">PRODUCER</h2></div></a></section>
    <section class="hidden-slide"><a href="/director/new-music-ensemble" class="image-container"><img id='mid-conductor' class='cropped-image'><div class="text-wrapper"><h2 class="text-overlay1">CONDUCTOR</h2></div></a></section>

    <script>
        (function() {
            const perfVids = ["https://www.cameronjohnston.xyz/s/performer1.mov", "https://www.cameronjohnston.xyz/s/performer2.mov", "https://www.cameronjohnston.xyz/s/performer3.mov", "https://www.cameronjohnston.xyz/s/performer4.mov", "https://www.cameronjohnston.xyz/s/performer5.mov"];
            const artVids = ["https://www.cameronjohnston.xyz/s/yt5sio-args-piece-for-processed-algorthmic-piano-and-video-1080p.mp4", "https://www.cameronjohnston.xyz/s/Screen-Recording-2023-01-26-at-11152-PM-HD-1080p-H264-Proxy-half-size.mov", "https://www.cameronjohnston.xyz/s/Screen-Recording-2023-01-30-at-13338-PM.mov"];

            const avPics = ['https://images.squarespace-cdn.com/content/5a6fccf8d74cff4818ad90a2/b2eed1d5-c15c-4e2d-9001-4a047b76e57e/IMG_2197.jpg', 'https://images.squarespace-cdn.com/content/5a6fccf8d74cff4818ad90a2/6896b182-d731-4893-8676-9a12495868bd/IMG_0660.jpg'];
            const compPics = ['https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63e182f98cf4a24371792881/1675723513560/composer1.png', 'https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63e182ff0d578b703b2ed5da/1675723519731/composer2.png'];
            const prodPics = ['https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63eac508a299f16299dff71b/1676330252119/producer.png'];
            const progPics = ['https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63eac4ee26ee86324adf12e4/1676330223142/programmer.png'];
            const soundPics = ["https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63eac4d4ce5623181979fd5f/1676330197349/sound1.png", "https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63eac4df39daf40fc36ae73f/1676330208773/sound2.png"];
            const condPics = ['https://static1.squarespace.com/static/5a6fccf8d74cff4818ad90a2/t/63e1830bb646bc07630e009b/1675723532190/conductor.png'];

            // --- GLITCH EFFECT SETTINGS ---
            const fontClasses = ['font1', 'font2', 'font3', 'font4', 'font5', 'font6'];
            const katakanaMap = {
                'A': 'ア', 'B': 'ブ', 'C': 'ク', 'D': 'デ', 'E': 'エ',
                'F': 'フ', 'G': 'グ', 'H': 'ハ', 'I': 'イ', 'J': 'ジ',
                'K': 'ケ', 'L': 'ル', 'M': 'ム', 'N': 'ン', 'O': 'オ',
                'P': 'プ', 'Q': 'キュ', 'R': 'ラ', 'S': 'ス', 'T': 'ト',
                'U': '牛', 'V': 'ヴ', 'W': 'ワ', 'X': 'クス', 'Y': 'ヤ', 'Z': 'ズ'
            };

            function changeFontRandomly(span) {
                if (!span.dataset.original) {
                    span.dataset.original = span.innerText;
                }
                fontClasses.forEach(fontClass => span.classList.remove(fontClass));
                const randomIndex = Math.floor(Math.random() * fontClasses.length);
                span.classList.add(fontClasses[randomIndex]);

                if (Math.random() < 0.05) {
                    const originalChar = span.dataset.original.toUpperCase();
                    if (katakanaMap[originalChar]) {
                        span.innerText = katakanaMap[originalChar];
                    }
                } else {
                    span.innerText = span.dataset.original;
                }

                const interval = Math.floor(Math.random() * (700 - 300 + 1)) + 300;
                setTimeout(() => changeFontRandomly(span), interval);
            }

            function applyGlitchToElements(selector) {
                const elements = document.querySelectorAll(selector);
                elements.forEach(el => {
                    // Prevent re-applying if already applied (check if children are spans with class glitch-char)
                    if (el.querySelector('.glitch-char')) return;

                    const text = el.innerText;
                    el.innerHTML = ''; // Clear existing text
                    for (let char of text) {
                        const span = document.createElement('span');
                        span.innerText = char;
                        span.className = 'glitch-char';
                        // Handle spaces visually
                        if (char === ' ') {
                           span.style.whiteSpace = 'pre';
                        }
                        el.appendChild(span);
                        
                        // Start effects
                        changeFontRandomly(span);
                    }
                });
            }

            let timeouts = {};

            function swapWithDelay(elementId, videoList) {
                const v = document.getElementById(elementId);
                if (!v) return;

                if(timeouts[elementId]) clearTimeout(timeouts[elementId]);

                v.style.opacity = "0";

                const timerPromise = new Promise(resolve => setTimeout(resolve, 1500));

                v.src = videoList[Math.floor(Math.random() * videoList.length)];
                v.load();

                const videoReadyPromise = new Promise(resolve => {
                    v.oncanplaythrough = resolve;
                });

                Promise.all([timerPromise, videoReadyPromise]).then(() => {
                    v.play().catch(() => {});
                    v.style.opacity = "1";
                    startWatchdog(elementId, videoList);
                });
            }

            function startWatchdog(elementId, videoList) {
                timeouts[elementId] = setTimeout(() => {
                    swapWithDelay(elementId, videoList);
                }, 10000);
            }

            function initEverything() {
                // 1. SETUP IMAGES
                const pics = {"mid-av": avPics, "mid-composer": compPics, "mid-producer": prodPics, "mid-programmer": progPics, "sound": soundPics, "mid-conductor": condPics};
                for (let id in pics) {
                    const el = document.getElementById(id);
                    if(el) el.src = pics[id][Math.floor(Math.random() * pics[id].length)];
                }

                // 2. SETUP VIDEOS
                const v = document.getElementById("mid-video");
                const l = document.getElementById("mid-laptop");

                if(v) {
                    v.src = artVids[0];
                    v.onended = () => swapWithDelay("mid-video", artVids);
                    startWatchdog("mid-video", artVids);
                }
                if(l) {
                    l.src = perfVids[0];
                    l.onended = () => swapWithDelay("mid-laptop", perfVids);
                    startWatchdog("mid-laptop", perfVids);
                }

                // 3. SETUP RANDOM FLY-IN
                document.querySelectorAll('.hp-mid-wrapper .hidden-slide').forEach(el => {
                    const randomX = (Math.random() - 0.5) * 1600;
                    const randomY = (Math.random() - 0.5) * 1000;
                    const randomRotate = (Math.random() - 0.5) * 40;
                    el.style.transform = `translate(${randomX}px, ${randomY}px) rotate(${randomRotate}deg)`;
                });

                // 4. OBSERVER (ONE WAY)
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            entry.target.classList.add('show-slide');
                            observer.unobserve(entry.target);
                        }
                    });
                }, { threshold: 0.1, rootMargin: "0px 0px -10% 0px" });

                document.querySelectorAll('.hp-mid-wrapper .hidden-slide').forEach(el => observer.observe(el));

                // 5. APPLY GLITCH EFFECT
                applyGlitchToElements('.hp-mid-wrapper .text-overlay, .hp-mid-wrapper .text-overlay1');
            }

            const checkLoad = setInterval(() => {
                if (document.getElementById('mid-composer') || document.getElementById('mid-av')) { initEverything(); clearInterval(checkLoad); }
            }, 100);
            setTimeout(() => clearInterval(checkLoad), 5000);
        })();
    </script>
</div>
</body>
